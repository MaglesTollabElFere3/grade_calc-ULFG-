<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Grade calc</title>
<style>
body{
    margin:0;
    font-family:Arial;
    background:#0b1324;
    color:#fff;
}
header{
    background:#1e3a5f;
    padding:15px;
    display:flex;
    align-items:center;
    justify-content:space-between;
}
header img{
    width:60px;
}
header .center{
    text-align:center;
    flex:1;
}
header h1{
    margin:0;
}
header p{
    margin:5px 0 0;
    font-size:18px;
}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}
th,td{
    border:1px solid #2c3e50;
    padding:10px;
    text-align:center;
}
th{
    background:#1e3a5f;
}
input{
    width:60px;
}
button{
    padding:5px 10px;
    margin:2px;
    background:#2e86de;
    color:white;
    border:none;
    border-radius:5px;
    cursor:pointer;
}
.fail{
    color:#ff9f9f;
    font-weight:bold;
}
#gpaBox{
    margin:15px;
    font-size:22px;
    text-align:center;
}
</style>
</head>

<body>

<header>
    <img src="logo.png">
    <div class="center">
        <h1>Grade calc</h1>
        <p>{وَقُلْ رَبِّ زِدْنِي عِلْمًا}</p>
    </div>
</header>

<table id="table">
<tr>
<th>Action</th>
<th>Average</th>
<th>Raise</th>
<th>Final</th>
<th>Partial</th>
<th>Credits</th>
<th>المادة</th>
</tr>

<tr>
<td>
<button onclick="applyRaise(this)">Raise</button>
<button onclick="editRow(this)">Edit</button>
</td>
<td class="avg">0</td>
<td class="raise">0</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td>subject</td>
</tr>

</table>

<div id="gpaBox">GPA: 0.00</div>

<script>
function applyRaise(btn){
    let row = btn.parentElement.parentElement;
    let final = Number(row.cells[3].querySelector("input").value);
    let partial = Number(row.cells[4].querySelector("input").value);
    let credits = Number(row.cells[5].querySelector("input").value);

    let high = Math.max(final,partial);
    let low  = Math.min(final,partial);
    let classAvg = high*0.6 + low*0.4;

    let raise = classAvg < 66 ? (66 - classAvg) : 0;
    let subjectAvg = classAvg + raise;

    row.cells[1].innerText = subjectAvg.toFixed(2);
    row.cells[2].innerText = raise.toFixed(2);

    row.cells[1].className = subjectAvg < 60 ? "fail" : "";

    calcGPA();
}

function editRow(btn){
    let row = btn.parentElement.parentElement;
    row.cells[1].innerText = 0;
    row.cells[2].innerText = 0;
    row.cells[1].className = "";
    calcGPA();
}

function calcGPA(){
    let rows = document.querySelectorAll("#table tr");
    let sum = 0;
    let creditsSum = 0;

    rows.forEach((r,i)=>{
        if(i===0) return;
        let avg = Number(r.cells[1].innerText);
        let cr = Number(r.cells[5].querySelector("input").value);
        if(avg>0 && cr>0){
            sum += avg * cr;
            creditsSum += cr;
        }
    });

    let gpa = creditsSum ? (sum/creditsSum) : 0;
    document.getElementById("gpaBox").innerText = "GPA: " + gpa.toFixed(2);
}
</script>

</body>
</html>
