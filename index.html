<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grade Calc</title>

  <style>
    :root {
      --blue: #2563eb;
      --bg-light: #f1f5f9;
      --card-light: #ffffff;
      --bg-dark: #0f172a;
      --card-dark: #020617;
      --text-light: #020617;
      --text-dark: #e5e7eb;
      --fail: #fecaca;
    }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg-dark);
      color: var(--text-dark);
      padding: 20px;
    }

    body.light {
      background: var(--bg-light);
      color: var(--text-light);
    }

    header {
      position: relative;
      text-align: center;
      margin-bottom: 20px;
    }

    header img {
      position: absolute;
      top: 0;
      left: 0;
      width: 70px;
    }

    h1 {
      color: var(--blue);
      margin-bottom: 10px;
    }

    .ayah {
      font-size: 18px;
      margin-bottom: 10px;
    }

    button {
      padding: 8px 14px;
      border-radius: 6px;
      border: none;
      background: var(--blue);
      color: white;
      cursor: pointer;
      margin: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      border: 1px solid #94a3b8;
      padding: 6px;
      text-align: center;
    }

    input {
      width: 90%;
      padding: 4px;
    }

    .fail {
      background: var(--fail);
    }

    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .avg-box {
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>

<header>
  <!-- Ø¶Ø¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø³Ù… logo.png Ø¯Ø§Ø®Ù„ Ø§Ù„Ø±ÙŠØ¨Ùˆ -->
  <img src="logo.png" alt="Faculty Logo">
  <h1>Grade Calc</h1>
  <div class="ayah" id="ayah">{ÙˆÙÙ‚ÙÙ„Ù’ Ø±ÙØ¨ÙÙ‘ Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§}</div>
  <label>
    <input type="checkbox" checked onchange="toggleAyah(this)"> Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¢ÙŠØ©
  </label>
</header>

<div class="controls">
  <button onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©</button>
  <button onclick="toggleTheme()">ğŸŒ™ / â˜€ï¸</button>
</div>

<table id="gradesTable">
  <thead>
    <tr>
      <th>Ø§Ù„Ù…Ø§Ø¯Ø©</th>
      <th>Credits</th>
      <th>Partial</th>
      <th>Final</th>
      <th>Raise</th>
      <th>Average</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="avg-box" id="overall"></div>

<script>
  function addRow() {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td><input></td>
      <td><input type="number"></td>
      <td><input type="number" oninput="calculate()"></td>
      <td><input type="number" oninput="calculate()"></td>
      <td class="raise">0</td>
      <td class="avg">0</td>
    `;
    document.querySelector('#gradesTable tbody').appendChild(row);
  }

  function calculate() {
    let total = 0;
    let creditsSum = 0;

    document.querySelectorAll('#gradesTable tbody tr').forEach(row => {
      const credits = Number(row.children[1].querySelector('input').value);
      const p = Number(row.children[2].querySelector('input').value);
      const f = Number(row.children[3].querySelector('input').value);

      if (!credits || !p || !f) return;

      const high = Math.max(p, f);
      const low = Math.min(p, f);
      let avg = high * 0.6 + low * 0.4;

      let raise = 0;
      if (avg < 66) raise = 66 - avg;

      const finalAvg = avg + raise;

      row.children[4].innerText = raise.toFixed(2);
      row.children[5].innerText = finalAvg.toFixed(2);

      row.classList.toggle('fail', finalAvg < 60);

      total += finalAvg * credits;
      creditsSum += credits;
    });

    if (creditsSum > 0) {
      document.getElementById('overall').innerText =
        `Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ù…: ${(total / creditsSum).toFixed(2)}`;
    }
  }

  function toggleTheme() {
    document.body.classList.toggle('light');
  }

  function toggleAyah(checkbox) {
    document.getElementById('ayah').style.display = checkbox.checked ? 'block' : 'none';
  }
</script>

</body>
</html>
